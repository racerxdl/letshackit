<!DOCTYPE html>
<html lang="en">

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <meta name="viewport" property="viewport" content="width=device-width, initial-scale=1.0">

  
  

  

  

  

  

  <title>Running code in a PAX Credit Card Payment Machine (part1) | Lets Hack It</title>

  <!-- Global -->
  <link rel="canonical" href="https://lucasteske.dev/2025/09/running-code-in-pax-machines">
  <meta name="generator" property="generator" content="Jekyll v4.4.1">
  <meta name="author" property="author" content="Lucas Teske">
  <meta name="description" property="description" content="Disclaimer All procedures described here were done with public available stuff - No security flaws were actually explored here to get code execution. The processor swap technique does not bypass the tamper protections neither allow a fake machine to actually emit payments. Brazilian credit card payment machines usually are in...">
  
  <meta name="keywords" content="Flash, PAX, Hardware Hacking, RE, Reverse Engineering, D177, D188, Minizinha, Moderninha, Smart, Sunmi, TecToy, Transire, Megahunt, MH1903, Air105, LuatOS">
  
  <!-- Open Graph -->
  <meta name="og:locale" property="og:locale" content="en">
  <meta name="og:type" property="og:type" content="article">
  <meta name="og:title" property="og:title" content="Running code in a PAX Credit Card Payment Machine (part1) | Lets Hack It">
  <meta name="og:url" property="og:url" content="https://lucasteske.dev/2025/09/running-code-in-pax-machines">
  <meta name="og:image" property="og:image" content="https://lucasteske.dev/assets/Running code in a PAX Credit Card Payment Machine/7383f9c5e7832856c90b25549fb08115_MD5.jpeg">
  <meta name="og:site_name" property="og:site_name" content="Lets Hack It">
  <meta name="og:description" property="og:description" content="Disclaimer All procedures described here were done with public available stuff - No security flaws were actually explored here to get code execution. The processor swap technique does not bypass the tamper protections neither allow a fake machine to actually emit payments. Brazilian credit card payment machines usually are in...">

  <!-- Article -->
  <meta name="article:author" property="article:author" content="https://www.facebook.com/teskeslab">
  <meta name="article:publisher" property="article:publisher" content="https://www.facebook.com/teskeslab">
  <meta name="article:published_time" property="article:published_time" content="2025-09-05T16:30:00-03:00">

  <!-- Facebook -->
  <meta name="fb:admins" property="fb:admins" content="1234">
  <meta name="fb:app_id" property="fb:app_id" content="1209208119176770">

  <!-- Twitter -->
  <meta name="twitter:card" property="twitter:card" content="summary_large_image">
  <meta name="twitter:title" property="twitter:title" content="Running code in a PAX Credit Card Payment Machine (part1) | Lets Hack It">
  <meta name="twitter:site" property="twitter:site" content="@lucasteske">
  <meta name="twitter:creator" property="twitter:creator" content="@lucasteske">
  <meta name="twitter:description" property="twitter:description" content="Disclaimer All procedures described here were done with public available stuff - No security flaws were actually explored here to get code execution. The processor swap technique does not bypass the tamper protections neither allow a fake machine to actually emit payments. Brazilian credit card payment machines usually are in...">
  <meta name="twitter:image" property="twitter:image" content="https://lucasteske.dev/assets/Running code in a PAX Credit Card Payment Machine/7383f9c5e7832856c90b25549fb08115_MD5.jpeg">
  <meta name="twitter:image:alt" property="twitter:image:alt" content="Disclaimer All procedures described here were done with public available stuff - No security flaws were actually explored here to get code execution. The processor swap technique does not bypass the tamper protections neither allow a fake machine to actually emit payments. Brazilian credit card payment machines usually are in...">

  <!-- JSON LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "url": "https://lucasteske.dev/2025/09/running-code-in-pax-machines",
    "name": "Running code in a PAX Credit Card Payment Machine (part1) | Lets Hack It",
    "headline": "Running code in a PAX Credit Card Payment Machine (part1) | Lets Hack It",
    "keywords": "Flash,PAX,Hardware Hacking,RE,Reverse Engineering,D177,D188,Minizinha,Moderninha,Smart,Sunmi,TecToy,Transire,Megahunt,MH1903,Air105,LuatOS",
    "description": "Disclaimer All procedures described here were done with public available stuff - No security flaws were actually explored here to get code execution. The processor swap technique does not bypass the tamper protections neither allow a fake machine to actually emit payments. Brazilian credit card payment machines usually are in...",
    "articleBody": "Disclaimer All procedures described here were done with public available stuff - No security flaws were actually explored here to get code execution. The processor swap technique does not bypass the tamper protections neither allow a fake machine to actually emit payments. Brazilian credit card payment machines usually are in state of the art regarding security measures. I remember once a Elavon employee told me that Brazil got all the first releases of payment machines and systems. When asked why, he said: frauds in Brazil are sophisticated enough, that if the system is secure enough to Brazil, it works for anywhere in the world. In the future, I will make an article about the security measures that both, MegaHunt, PAX and Brazilian companies implement in their machines to avoid systems to be tampered with. If you’re sharing / commenting over this article, please put the same disclaimer there. I don’t mind using information here to make new articles, but Brazil suffers a lot with fake news (specially involving security hardware made here) and someone can think that makes it possible to hack their credit cards or accounts (you know, people lacking the knowledge to actually understand whats involved). Head Notes...",
    "datePublished": "2025-09-05 16:30:00 -0300",
    "dateModified": "2025-09-05 16:30:00 -0300",
    "author": {
      "@type": "Person",
      "name": "Lucas Teske",
      "email": "letshackit@nvx.li"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Lets Hack It",
      "url": "https://lucasteske.dev",
      "logo": {
        "@type": "ImageObject",
        "width": 32,
        "height": 32,
        "url": "https://lucasteske.dev/icon/favicon.ico"
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://lucasteske.dev/2025/09/running-code-in-pax-machines"
    },
    "image": {
      "@type": "ImageObject",
      "url": "https://lucasteske.dev/assets/Running code in a PAX Credit Card Payment Machine/7383f9c5e7832856c90b25549fb08115_MD5.jpeg"
    }
  }
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
  <link rel="stylesheet" href="/assets/theme.css">
  <link rel="stylesheet" href="/assets/flag-icon.min.css">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/assets/favicon.ico">
  <meta name="msapplication-TileColor" property="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" property="msapplication-config" content="/assets/browserconfig.xml">
  <meta name="theme-color" property="theme-color" content="#ffffff">

  <!-- Custom Scripts -->
  <script async src="/assets/syntaxhighlighter.min.js"></script>
  <script async src="/assets/simple-jekyll-search.min.js"></script>

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="https://lucasteske.dev/feed.xml" title="Lets Hack It">

  <!-- Google Analytics-->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-32251405-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-32251405-2');
</script>
  
</head>

  <body>
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/pt_BR/sdk.js#xfbml=1&amp;version=v4.0&amp;appId=1209208119176770&amp;autoLogAppEvents=1"></script>
    <div class="like-box">
      <div class="fb-like" data-href="https://lucasteske.dev/2025/09/running-code-in-pax-machines" data-width="" data-layout="box_count" data-action="like" data-size="large" data-show-faces="true" data-share="true"></div>
    </div>
    <a href="https://github.com/racerxdl/letshackit" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
    <main class="site">
      
<br>
<img src="/assets/cropped-logo.png" style="margin-left: auto; margin-right: auto;">
<ul class="language-bar">
  
  
  <a class="link-pt flag-icon flag-icon-us" href="/2025/09/running-code-in-pax-machines"></a>
  <a class="link-en flag-icon flag-icon-br" href="/pt/2025/09/running-code-in-pax-machines"></a>
</ul>
<nav class="nav">
  <div class="nav-container" style="height: 50px">
    <ul class="navul">
      <li><a href="/">Home</a></li>
    
      <li><a href="/donate">Donate</a></li>
      <li><a href="/calculators">Calculators</a></li>
      <li><a href="/my-presentations">My Presentations</a></li>
      <li><a href="/satcom-projects">Satcom Projects</a></li>
      <li><a href="/my-tesla-coils">My Tesla Coils</a></li>
      <li><a href="/biggateboy">Big Gate Boy</a></li>
      <li><a href="/about">About</a></li>
    
    </ul>
  </div>
</nav>
<div class="social-icon">
  <ul>
    <li class="btn-a btn-svg btn-twitch">
      <a href="https://twitch.tv/racerxdl">
        <svg role="img" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><title>Twitch icon</title>
<path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"></path></svg>

        RacerXDL
      </a>
    </li>
    <li class="btn-a btn-svg btn-twitter">
      <a href="https://twitter.com/lucasteske">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter icon</title>
<path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg>
        @lucasteske
      </a>
    </li>
    <li class="btn-a btn-svg btn-instagram">
      <a href="https://instagram.com/racerxdl/">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Instagram icon</title>
<path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"></path></svg>
        @racerxdl
      </a>
    </li>
    <li class="btn-a btn-svg btn-facebook">
      <a href="https://www.facebook.com/teskeslab">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Facebook icon</title>
<path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg>
        Teske's Lab
      </a>
    </li>
    <li class="btn-a btn-svg btn-github">
      <a href="https://github.com/racerxdl">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title>
<path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
        @racerxdl
      </a>
    </li>
<br>
    <li class="btn-a btn-svg btn-youtube">
      <a href="https://www.youtube.com/c/TeskesLab">
        <svg role="img" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><title>YouTube icon</title>
<path d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"></path></svg>
        Teske's Lab
      </a>
    </li>
    <li class="btn-a btn-svg btn-linkedin">
      <a href="https://www.linkedin.com/in/lucas-teske-8206301b/">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn icon</title>
<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg>
        Lucas Teske
      </a>
    </li>
    <li class="btn-a btn-svg btn-code-stats">
      <a href="https://codestats.net/users/racerxdl">
        <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="360px" height="360px" viewbox="0 0 360 360" enable-background="new 0 0 360 360" xml:space="preserve">
<path d="M174,81.741v27.509C161.913,104,133.5,93.5,109.789,94.6c-23.859,1.107-42.172,7.301-54.859,21.902
	c-12.689,14.603-19.033,35.71-19.033,63.326c0,27.524,6.344,48.585,19.033,63.186c12.687,14.603,30.974,21.901,54.859,21.901
	c12.127,0,41.461-5.665,64.211-19.115v29.528c-8.75,2.672-33.75,12.422-65.891,12.818c-31.625,0.39-56.538-9.678-74.731-29.039
	c-18.193-19.358-27.29-45.784-27.29-79.28c0-33.587,9.097-60.059,27.29-79.42c18.193-19.358,43.113-28.252,74.731-29.039
	C133,70.75,155.808,77.431,174,81.741z M341.423,82.005v27.569c-10.729-5.13-20.852-8.957-30.368-11.476s-18.707-3.778-27.569-3.778
	c-15.395,0-27.268,2.987-35.616,8.957c-8.352,5.972-12.525,14.462-12.525,25.47c0,9.236,2.774,16.212,8.327,20.922
	c5.55,4.712,16.069,8.515,31.558,11.406l17.073,3.499c21.084,4.013,36.643,11.08,46.673,21.202
	c10.027,10.124,15.044,23.675,15.044,40.654c0,20.247-6.787,35.595-20.362,46.043c-13.575,10.45-33.472,15.674-59.688,15.674
	c-9.89,0-20.41-1.119-31.558-3.358c-11.15-2.239-22.695-5.55-34.637-9.937v-29.109c11.476,6.438,22.717,11.29,33.727,14.555
	c11.008,3.267,21.832,4.898,32.468,4.898c16.14,0,28.596-3.171,37.366-9.517c8.769-6.344,13.155-15.395,13.155-27.149
	c0-10.262-3.149-18.285-9.447-24.071c-6.297-5.783-16.632-10.122-30.998-13.015l-17.213-3.358
	c-21.086-4.199-36.341-10.776-45.763-19.733c-9.425-8.957-14.135-21.412-14.135-37.366c0-18.473,6.508-33.027,19.522-43.664
	c13.015-10.636,30.95-15.954,53.81-15.954c9.796,0,19.778,0.888,29.948,2.659C320.383,75.801,330.787,78.46,341.423,82.005z"></path>
<path d="M86.199,153.037c0-2.98,1.024-5.495,3.074-7.544c2.048-2.048,4.563-3.073,7.544-3.073c3.034,0,5.561,1.011,7.584,3.034
	c2.022,2.023,3.034,4.55,3.034,7.584s-1.012,5.563-3.034,7.584c-2.023,2.023-4.551,3.034-7.584,3.034
	c-2.981,0-5.496-1.024-7.544-3.074C87.223,158.533,86.199,156.018,86.199,153.037z M86.199,205.089c0-2.979,1.024-5.509,3.074-7.584
	c2.048-2.076,4.563-3.113,7.544-3.113c2.98,0,5.495,1.037,7.544,3.113c2.048,2.075,3.074,4.604,3.074,7.584
	c0,2.981-1.012,5.496-3.034,7.545c-2.023,2.048-4.551,3.073-7.584,3.073s-5.562-1.025-7.584-3.073
	C87.209,210.585,86.199,208.07,86.199,205.089z M141.135,153.037c0-2.98,1.024-5.495,3.074-7.544
	c2.048-2.048,4.563-3.073,7.544-3.073c3.034,0,5.561,1.011,7.584,3.034c2.022,2.023,3.034,4.55,3.034,7.584
	s-1.012,5.563-3.034,7.584c-2.023,2.023-4.551,3.034-7.584,3.034c-2.981,0-5.496-1.024-7.544-3.074
	C142.159,158.533,141.135,156.018,141.135,153.037z M141.135,205.089c0-2.979,1.024-5.509,3.074-7.584
	c2.048-2.076,4.563-3.113,7.544-3.113c2.98,0,5.495,1.037,7.544,3.113c2.048,2.075,3.074,4.604,3.074,7.584
	c0,2.981-1.012,5.496-3.034,7.545c-2.023,2.048-4.551,3.073-7.584,3.073s-5.563-1.025-7.584-3.073
	C142.146,210.585,141.135,208.07,141.135,205.089z"></path>
</svg>

        racerxdl
      </a>
    </li>
<br>
    <li class="btn-a btn-svg btn-telegram">
      <a href="https://t.me/hardwareHackingBrasil">
        <svg role="img" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><title>Telegram icon</title>
<path d="M23.91 3.79L20.3 20.84c-.25 1.21-.98 1.5-2 .94l-5.5-4.07-2.66 2.57c-.3.3-.55.56-1.1.56-.72 0-.6-.27-.84-.95L6.3 13.7l-5.45-1.7c-1.18-.35-1.19-1.16.26-1.75l21.26-8.2c.97-.43 1.9.24 1.53 1.73z"></path></svg>
        Hardware Hacking Brasil
      </a>
    </li>
    <li class="btn-a btn-svg btn-patreon">
      <a href="https://www.patreon.com/teskeslab">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Patreon</title>
<path d="M0 .48v23.04h4.22V.48zm15.385 0c-4.764 0-8.641 3.88-8.641 8.65 0 4.755 3.877 8.623 8.641 8.623 4.75 0 8.615-3.868 8.615-8.623C24 4.36 20.136.48 15.385.48z"></path></svg>
        Patreon
      </a>
    </li>
    <li class="btn-a btn-svg btn-mastodon">
      <a rel="me" href="https://infosec.exchange/@lucasteske">
        <svg width="24px" height="24px" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xml:space="preserve"><path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path></svg>
        Mastodon
      </a>
    </li>
    <li class="btn-a btn-svg btn-bluesky">
      <a rel="me" href="https://bsky.app/profile/lucasteske.dev">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Bluesky</title>
<path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"></path></svg>
        Bluesky
      </a>
    </li>
  </ul>
</div>
<div class="search-input">
  <input type="text" id="search-input" style="margin: 0 auto;" placeholder="Search blog posts...">
</div>
<ul id="results-container" class="results-container"></ul>

      





<div class="post">
  <h1 class="post-title">Running code in a PAX Credit Card Payment Machine (part1)</h1>
  <div class="post-info">
    
      <img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/7383f9c5e7832856c90b25549fb08115_MD5.jpeg">
    
    <span>Written by</span>
    
        Lucas Teske
    
    

    
      <br>
      <span>on </span><time datetime="2025-09-05 16:30:00 -0300">
  5
  
  September
  2025
</time>
    
  </div>

  <div class="post-line"></div>

  <h2 id="disclaimer">Disclaimer</h2>

<p><strong>All procedures described here were done with public available stuff</strong> - No security flaws were actually explored here to get code execution. The processor swap technique <strong>does not bypass the tamper protections neither allow a fake machine to actually emit payments.</strong></p>

<p>Brazilian credit card payment machines <em>usually</em> are in state of the art regarding security measures. I remember once a Elavon employee told me that <strong>Brazil got all the first releases of payment machines and systems</strong>. When asked why, he said: <strong>frauds in Brazil are sophisticated enough, that if the system is secure enough to Brazil, it works for anywhere in the world</strong>.</p>

<p>In the future, I will make an article about the security measures that both, MegaHunt, PAX and Brazilian companies implement in their machines to avoid systems to be tampered with.</p>

<p>If you’re sharing / commenting over this article, please put the same disclaimer there. I don’t mind using information here to make new articles, but Brazil suffers a <strong>lot</strong> with fake news (specially involving security hardware made here) and someone can think that makes it possible to hack their credit cards or accounts (you know, people lacking the knowledge to actually understand whats involved).</p>

<h3 id="head-notes">Head Notes</h3>

<p>This article is sort of incomplete. I will still publish the reverse engineering of the boot rom and how I created an emulator to better map out what the firmares do. Here I just mention briefly that I did an emulator and I think that deserves its own article. I will update this head note when they’re published.</p>

<p>I want to thank <a href="https://www.linkedin.com/in/gutem/">Gutem</a> and <a href="https://www.instagram.com/penegui">Penegui</a> for a quick technical review of the tech content of the article, and Pag, which gave a really fast and friendly response when I sent to them. A short timeline is provided at bottom of this page.</p>

<h2 id="credit-card-payment-machines">Credit card payment machines</h2>

<p>Here in Brazil, there are several companies that act as payment gateways and these sort of stuff. I would guess the biggest ones are <a href="https://pagbank.com.br/">PagSeguro</a> and <a href="https://mercadopago.com.br/">MercadoPago</a>. While PagSeguro is originally from Brazil, MercadoPago is from Argentina and came from a completely different business (MercadoLivre, which is basically the south american equivalent of eBay).</p>

<p>There are also lots of banks that also has payment machines nowadays, but I would guess most of them, if not all, buy the machines from a Brazilian manufacturer called <a href="https://www.tectoy.com.br/">TecToy</a> (which was previously done only by <a href="https://www.transire.com/">Transire</a>, but now they’re merged into the same company).</p>

<p>I find it funny, because TecToy is a toy maker, but they are huge and old and basically one of the few surviving companies that <strong>actually make hardware</strong> in Brazil. Nonetheless to say, the machines are not designed by them, but most by Chinese OEM. Mostly nowadays, its either <a href="https://www.paxglobal.com.hk/">PAX</a> or <a href="https://www.sunmi.com/">Sunmi</a>.</p>

<p>In Brazil, its very easy and cheap to buy them basically anywhere, easiest ones are from the companies I described above (Pag and MP). For example, for PagSeguro, you can find them in their website.</p>

<p>Just for a reference, by the time I wrote this article, US$1 ~ R$5,48 so most of these machines are under US$20, which is cheap even for Brazilian standards by the hardware they posses.</p>

<p>Mercado pago is a bit more expensive, but easier to buy since you can just go to their normal market place (Mercado Livre) which is like EBay and buy the machines (see <a href="https://lista.mercadolivre.com.br/maquina-de-cart%C3%A3o#D[A:Maquina%20de%20Cart%C3%A3o]">https://lista.mercadolivre.com.br/maquina-de-cart%C3%A3o#D[A:Maquina%20de%20Cart%C3%A3o]</a> )</p>

<p>In short: they are usually PAX based machines, with same “Operating System” but custom application which are totally different beast between then. Additionally, Pag also does “Merchant OEM” and <strong>lots</strong> of payment companies that offer machines actually use a unbranded Pag machine and use their API for doing all the stuff (so for any Brazilians reading this, if you buy a machine that’s not from MP or Pag, chances are, its from Pag anyways).</p>

<p>For sake of simplicity, these machines correspond to these PAX ones:</p>

<ul>
  <li>Mini Chip 3 - PAX D188 (Baremetal)</li>
  <li>Moder Plus 2 - PAX D195 (Linux OS)</li>
  <li>Moder Pro 2 - PAX Q92S (Linux OS)</li>
  <li>Mini NFC 2 - PAX D177 (Baremetal)</li>
  <li>Mini Smart 2 - Sunmi P2 (Android)</li>
</ul>

<p>For this article, I decided to use the Mini NFC 2, which is a simple and cheap PAX D177. Worth notice, that even though the Chip 3 (D188) looks way more advanced, it has basically the same hardware as D177, but an additional LTE Modem and a bigger screen. Firmware that runs on both <strong>are basically the same</strong>.</p>

<h2 id="first-works-and-identifying-stuff">First works and Identifying stuff</h2>

<p>So usually for reversing secure hardware, I buy <strong>at least</strong> three machines when possible. Usually it goes like:</p>

<ol>
  <li>Will open, let every single protection trip on it</li>
  <li>Will use to <strong>try</strong> bypass protections (if needed to my objective)</li>
  <li>Will keep as is, for comparing with a working machine.</li>
</ol>

<p>In that specific scenario, I just wanted to run DOOM on them, just because, if it computes, it needs DOOM.</p>

<p>I had previous experience reverse engineering these machines, so most of the article is just an example how I would do it (for this article, it actually took me few years to get to the current state) and how I remember I did. So I was expecting:</p>

<ol>
  <li>Heavy security
    <ol>
      <li>Tamper protection</li>
      <li>Clock Glitching protection</li>
      <li>RNG Manipulation protection</li>
      <li>Code signatures</li>
      <li>Code encryption</li>
    </ol>
  </li>
  <li>Lots of frustration</li>
</ol>

<p>I could go into two ways for code running: Exploiting it, swapping CPU. For exploiting it, I would need to find a flaw that allowed to execute code through Bluetooth, Smartcard, NFC or USB. These are the only interfaces. For that, I would need to have the entire code, and as we will see, that was sort of not possible.</p>

<p>Second way, would be to get whatever CPU was in the board, remove it and install a new and unfused one. The problem with that, is to actually find the CPU to sell anywhere.</p>

<p>So either way, I would need to open the machine and identify stuff.
Just for the reference, the machine was this one:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/cb3d6416e80906d1e1a3cfa7c27ec46c_MD5.jpeg" alt=""></p>

<p>On the back side, there are few screws which are easily removed. I usually do this with the <strong>machine turned on</strong>. So I can see which actions would trigger the tamper protection.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/942368afcd3a8b5c2f6280b0686279ad_MD5.jpeg" alt="">
Removing the screws does not trigger the tamper protection, but removing the case does. In the picture below, you can see the case removed, and I highlighted two of the tamper detection points.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/9a88c682e238fdb16c61122c76c2e14c_MD5.jpeg" alt="">
on the back side of the case, there is some carbon-rubber points that touch these tamper points in the PCB. It works exactly the same as video game consoles controller buttons, but in this case, they just ensure the “button is always pressed”.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/3744913eb7cc7b866b64eb363d6fbbe5_MD5.jpeg" alt=""></p>

<p>And for some reason, the machine decided to tell us which one of the tampers we triggered :)</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/9b728a005ceb00f991633d8d6ece65ed_MD5.jpeg" alt="">
Also this resets over boot, do if you bridge them, you can use it to identify the names of each tamper point hehe.</p>

<p>So in this bottom part, we can see some stuff. There is the round coin cell battery in the left, and there is a big boring green PCB. They’re basically over the card reader and all the core circuits.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/4454b7008ef72e53db283abd4afafb86_MD5.jpeg" alt=""></p>

<p>Although this PCB looks boring, don’t get fooled by it. That’s basically a 4 layer PCB with a DENSE mesh inside it. Any damage or removal will trigger another tamper point. Just for quick reference, this is a scan of the PCB:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/930418d0ee33dd3362d0ac27de43fa8e_MD5.jpeg" alt=""></p>

<p>Removing all the plastic stuff, we reach the main PCB:
<img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/1d47f48f4cf614dd72e26c37c839895c_MD5.jpeg" alt=""></p>

<p>There is lot of stuff, but the stuff that we care in the bottom.
<img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/e808d21c32ba0866a386d155077709e4_MD5.jpeg" alt=""></p>

<p>Here we can see some interesting stuff:</p>

<ul>
  <li>MH1903 - Our main SoC (CPU)</li>
  <li>NXP 8035S - Smartcard Interface PHY</li>
  <li>FM17660 - NFC Reader</li>
  <li>XM25Q65 - 16MB SPI Flash Memory</li>
</ul>

<p>(And as you guessed, we trigger about every tamper point in the back)</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/55e76a7d0d22410d56bada5afad18bd8_MD5.jpeg" alt=""></p>

<p>The flash memory, we can dump it. I have both tampered and untampered dumps from it. Bypassing tamper is left as exercise for the reader :). But if you just want to understand how it works, you can just dump as is, since the tamper doesn’t actually erase the entire flash, but just some parameters for communicating with the payment servers.</p>

<p>I was expecting always that the flash would be encrypted, but it isn’t. Still, we can’t change its contents since its signed (everything is signed basically) so we can use it for reverse engineering but not for code execution. But its neat that it is a 16MB flash, so it fits a entire DOOM WAD file :D</p>

<h2 id="what-we-know-about-mh1903">What we know about MH1903</h2>

<p>So here is where things get REALLY annoying. This SoC is actually behind a curtain of obscurity. The core is done by MegaHunt, which only provides this as information:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/cf4f007fbd8b87c83cb0e4f3c3560cc7_MD5.jpeg" alt="">
(see <a href="https://www.megahuntmicro.com/en/index.php?catid=5">https://www.megahuntmicro.com/en/index.php?catid=5</a> )</p>

<p>Digging it a bit deeper in google, we can find few suppliers that has more info. It has <strong>lots</strong> of variants, but in short their core is the same, just changing exposed pins and/or flash/ram inside the SoC. That specific one, is the QFN88 version which has the following specs:</p>

<ul>
  <li>RAM: 1MB</li>
  <li>FLASH: 1MB</li>
  <li>SPI: 4</li>
  <li>ADC: 5</li>
  <li>DAC: 1</li>
  <li>GPIO: 64</li>
  <li>USB: 1</li>
  <li>Serial: 4</li>
</ul>

<p>As you can see, there is an internal flash which is a pity for me. I’m still building my gear to be able to probe directly to the flash. I already did some decaps, and the flash isn’t embedded in the main silicon, but just glued over the main die and bound wired to it. I heard from some people from semiconductor industry that this is because its very hard to do flash and CPU in the same process, at least with decent enough density, so its usually preferable (and cheaper) to make them separated.</p>

<p>One thing worth noticing though, the BGA versions does not have embedded flash, so their program are loaded from external flashes. Spoiler alert: the D188 has two flash memories onboard :)</p>

<p>Also there is the MH1903S variant with has a beefy spec on flash but less RAM and less GPIO / SPI</p>

<ul>
  <li>RAM: 640KB</li>
  <li>FLASH: 4MB</li>
  <li>SPI: 3</li>
  <li>ADC: 6</li>
  <li>DAC: 1</li>
  <li>GPIO: 56</li>
  <li>USB: 1</li>
  <li>Serial: 3</li>
</ul>

<p>So google didn’t had much information, although I did found some SDKs around github (mostly mirrored from chinese git) and I had to search in Baidu. So this part took a very long time, since lots of information are not available outside mainland china, and since there is several variants of MH1903, I got several datasheets with conflicting information. Also most of them I had to pay for accessing it on CSDN, which luckily there are some brokers that does that for you. In the foot of this page there is a note with a link to all datasheets I could find so if you ever need, there is there. Just be warned: lots of conflicted info and it seens some wrong and omitted stuff is everywhere.</p>

<p>So how did I test my assumptions? Well, I found <em>by a chance</em> that there is a arduino like chinese board from LUAT that uses an SoC called AIR105, it seens boring, but some of my baidu search pointed out that AIR105 actually uses a MH1903S core. The AIR105 are also available in aliexpress very easily to buy: <a href="https://s.click.aliexpress.com/e/_oBLNTrc">https://s.click.aliexpress.com/e/_oBLNTrc</a></p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/427a383619233fb72eef5161e05511e8_MD5.jpeg" alt=""></p>

<p>I bought a few, decaped one and guess what. it is indeed a MH1903S :D</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/9138886ea831b06c18888099fd0e26a6_MD5.jpeg" alt="">
As a reference, when I decaped one of t he SoC from the machine, the writing was 1903A:
<img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/feb55758da95a7ecb62f02451c058606_MD5.jpeg" alt="">
Also, remember when I said flash memory is glued over the main die? Here is a shot showing both of them (sorry, I didn’t made a focus stacking). Flash memory is the one out of focus in the right. Bound wires are dead because I used 78% Nitric Acid and they’re copper ones.
<img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/551efee7006a314cf9d0b9257bb61edc_MD5.jpeg" alt="">
<img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/4fd85cc5f052df9b22c267e7559b0af5_MD5.jpeg" alt="">
So basically, we could assume they’re similar at least. Their datasheets also tell about the same thing (seems like the only different is actually flash + ram)</p>

<p>The block diagram for this CPU is described in datasheet, and this is basically the only info that matches across <strong>all</strong> datasheets I’ve found:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/8cd0cc82e5b752464a0617442e0c765f_MD5.jpeg" alt=""></p>

<p>So SC300 is actually a ARM spec called SecurCore. Its a Cortex M3 (in case of MH190x is a M4F) with some security enhancements. For example, although they’re 32 bit simple ARMs, they have security boundaries between OS &lt;&gt; App which are configured in memory controller registers (primitive version of TrustZone). It also follows some standards that are only available under NDA, and I can only guess what they’re. Just for quick reference: The CPUs inside your credit cards, follow the exact same specification.</p>

<p>Datasheets also specifies some memory maps, which at least all datasheets agree, although its <strong>clearly</strong> not everything the device has. For example, MH claims that CPU has hardware acceleration for RSA, AES, hashes and stuff, but there is nothing in memory map of the datasheet. I found out later, that they’re just being obscure or require a NDA to that. I will eventually map everything by reverse engineering apps I dumped and some SDK with binaries I found over the internet. Also please let me know if these addresses matches any target arch you actually played with. I couldnt find anything, so it seens not a direct clone of any existing SoC in the market (I speculated a STM32 or ATSAMD but they dont match).</p>

<table>
  <thead>
    <tr>
      <th>Address Range</th>
      <th>Peripheral name</th>
      <th>Bus Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x4000_0000-0x4000_03FF</td>
      <td>SSC</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4000_0800-0x4000_0BFF</td>
      <td>DMA</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4000_0C00-0x4000_0FFF</td>
      <td>USB</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4000_1000-0x4000_13FF</td>
      <td>LCD</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4000_8000-0x4000_BFFF</td>
      <td>OTP</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4006_0000-0x4006_FFFF</td>
      <td>DCMI</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4008_0000-0x4008_FFFF</td>
      <td>CACHE</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x400A_2000-0x400A_2FFF</td>
      <td>QSPI</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x400A_3000-0x400A_3FFF</td>
      <td>SPIM5</td>
      <td>AHB</td>
    </tr>
    <tr>
      <td>0x4001_0000-0x4001_0FFF</td>
      <td>SCI0</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_2000-0x4001_2FFF</td>
      <td>CRC</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_3000-0x4001_3FFF</td>
      <td>Timer0</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_4000-0x4001_4FFF</td>
      <td>ADC</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_5000-0x4001_5FFF</td>
      <td>SCI2</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_6000-0x4001_6FFF</td>
      <td>UART0</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_7000-0x4001_7FFF</td>
      <td>UART1</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_8000-0x4001_8FFF</td>
      <td>SPIM1</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_9000-0x4001_9FFF</td>
      <td>SPIM2</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_A000-0x4001_AFFF</td>
      <td>SPIM0</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_B000-0x4001_BFFF</td>
      <td>SPIS0</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_C000-0x4001_CFFF</td>
      <td>Watchdog</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_D000-0x4001_DFFF</td>
      <td>GPIO</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_E000-0x4001_EFFF</td>
      <td>TRNG</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4001_F000-0x4001_FFFF</td>
      <td>SYS_CTRL</td>
      <td>APB0</td>
    </tr>
    <tr>
      <td>0x4002_0000-0x4002_FFFF</td>
      <td>MSR</td>
      <td>APB1</td>
    </tr>
    <tr>
      <td>0x4003_0000-0x4003_7FFF</td>
      <td>BPU</td>
      <td>APB2</td>
    </tr>
    <tr>
      <td>0x4004_4000-0x4004_4FFF</td>
      <td>UART2</td>
      <td>APB3</td>
    </tr>
    <tr>
      <td>0x4004_5000-0x4004_5FFF</td>
      <td>UART3</td>
      <td>APB3</td>
    </tr>
    <tr>
      <td>0x4004_8000-0x4004_8FFF</td>
      <td>KEYBOARD</td>
      <td>APB3</td>
    </tr>
    <tr>
      <td>0x4004_9000-0x4004_9FFF</td>
      <td>I2C0</td>
      <td>APB3</td>
    </tr>
  </tbody>
</table>

<p>RAM is mapped in the usual place for most of these ARM Cortex chips. They’re based on 0x2000_0000, and span up to the max size (640KB for MH1903S and 1MB for MH1903). The bit bands are also in the places we expected, being 0x2200_0000  for the SRAM. There are also more devices there, that I didn’t wrote here. These will have their own article after I finish mapping it everything I can.</p>

<p>The main MH1903S datasheet shows two variants of the QFN88, one having a <code class="language-plaintext highlighter-rouge">_J</code> suffix. The non J has a internal 3.3V regulator which is very handy for boards like the AIR105. By reverse engineering the D177 machine board, it seems like the pin-out almost exactly matches the J variant. We will see later, that I had a hard time because I assumed that the datasheet would be correct.</p>

<h2 id="finding-out-how-things-are-wired">Finding out how things are wired</h2>

<p>So first thing, I need to figure out <strong>at least</strong> where the UART is wired (if wired). I know the USB is wired to the hardware USB (since pins are fixed) but for some reason, I don’t see the boot rom up in the USB so I must find the direct UART.</p>

<p>UART pins are usually exposed for diagnostics during manufacturing, either that or JTAG. JTAG (or more specific here, SWD) in case of this device is disabled during boot, so I decided to not waste much time finding it in the board.</p>

<p>So how to start finding things on the board? Well I usually like to remove <strong>all</strong> components from the board and make a nice scan of it (using normal paper scanners). Then I overlay the pinout of the CPU and “trace back”. A nice application to do that is <a href="https://inkscape.org/">Inkscape</a>. It allows you to draw stuff vector based, and scanned images has 1:1 size match with real world (in case you need measurements).</p>

<p>Then I draw the pads as gray rectangles, name them:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/bacf2a2ebe249871db70adb98d4fa2b7_MD5.jpeg" alt="">
I usually like to mark vias as well, since these boards are multilayred and you probably will need it to fully follow the tracks:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/fdeaa9034f0f2a2217c7d55f05e2e6f4_MD5.jpeg" alt="">
For example this TX/RX tracks passes through the front of the PCB as well (don’t mind the misalignment, not sure why the image currently is like that)</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/652fd1331e348c4861938eadf3f0a824_MD5.jpeg" alt="">
After following it through, I reached 2 of the 5 test pads in the right corner of the backside of the PCB, which I also marked in inkscape.
<img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/985831c28a29ecc016e52f876980476a_MD5.jpeg" alt="">
So now that I had the UART, I could use it to reprogram the machine after a CPU Swap.
And for those who are wondering: this UART, application wise, is the same as the USB port and Bluetooth so no leaky stuff (usually) is there, but the same thing the mobile application acesses it. And if it does, you don’t actually need to open it, since Bluetooth / USB will leak it the same.</p>

<h2 id="cpu-swap">CPU Swap</h2>

<p>So one of the easiest ways I could get code running and skip requiring bypassing the secure boot of the MH devices is by just getting the CPU and swap. Some might consider this a vulnerability, although I personally don’t consider it: Even if someone gets hand in the entire code for the machines, there are still the keys and data loaded into the NVRAM which are used for the card transactions. I already saw some cases few years ago that the keys were actually stored inside the flash memory (so if you nuke the CPU before the tamper detect, you retain everything). That’s not the case of these machines.</p>

<p>Sadly these MH1903 devices are pretty rare to buy outside mainland china. From time to time they appear in Aliexpress as well. Here is an affiliate link: <a href="https://s.click.aliexpress.com/e/_oBMot6n">https://s.click.aliexpress.com/e/_oBMot6n</a> although it might be dead when you check this out (since they’re pretty rare).</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/c94d5244a68733e5cfbec91c6f08f5f0_MD5.jpeg" alt=""></p>

<p>So its a bit expensive, R$34 (CPU) + R$15 (TAX) per device, plus R$28 shipping. I bought 5 of them just in case which was about R$150 (US$28) with the shipping.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/edad8e809adbb209bf4eca20043fd1dd_MD5.jpeg" alt="">
Few years ago I tried swapping the CPU in that machine without any success. So I thought the issue was that the variant I had wasnt the J but the same as AIR105 (which would sort of make sense) and that made me sad. But I decided to try swap one of the AIR105 for that one just to dump the bootloader (more bootloaders = more info)</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/8fabf3473c8ee086fdea127b537c4ef6_MD5.jpeg" alt=""></p>

<p>After trying to that, I noticed the board was fully dead. No power besides the +5V. After swapping two boards I remember something I saw in the datasheet:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/725ff8aa056e6d095a4ac1ea1882fa1a_MD5.jpeg" alt=""></p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/839cea0de243ff5cc485a19e6a0fb849_MD5.jpeg" alt="">
One of the differences between the J and non J version, is that the <strong>non J</strong> version (in this case AIR105) had an internal 3.3V LDO. And checking the schematics of the AIR105 board, guess what? No regulator onboard, everything was powered from the LDO.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/87356f1a4622aa38a746dd5676123bf5_MD5.jpeg" alt=""></p>

<p>So it would make sense that the board doesn’t have any power at 3.3V, since the J version does not have it. So I decided to give another try swapping the CPU on the D177 board. For that, I decided a fully fresh start: new machine with the box just open and a not used MH1903 CPU. The result? Nothing from the board. Not on UART, not on USB (and there should be both activity).</p>

<p>Basically what happened is that, the boot rom never answered to handshake calls, which was odd. So I decided to give a try on the AIR105 board, just to notice that the board actually had to be reset by toggling the RTS signal in the serial port.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/fd96942840f9a3924a76e5d843ee88a2_MD5.jpeg" alt="">
So that made me wonder: How was it resetting the board? By looking at the pin-out, there is no reset button. But looking at AIR105 board schematic, we see a interesting thing:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/217023812ae3d8552e72a67306105efa_MD5.jpeg" alt=""></p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/0c7f3862853471f760b69c71098168a4_MD5.jpeg" alt=""></p>

<p>Basically, the board didn’t had any coin-cell battery where it should, just a capacitor for emulating the board (the XH311H battery in the schematic, is just a not populated connector in the board), and what the reset pin actually did, was to <strong>short it out</strong> the power supply at that pin, making it 0V. And guess what? The datasheet told me all the time, but my lack of Chinese reading skills just bypassed it 😆</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/7a75d13b7c4758f46f7c29717f7907cd_MD5.jpeg" alt="">
For those (like me) which is very rusty in Chinese, the marked text says basically: Battery power supply, must be powered otherwise the chip cannot work.</p>

<p>So I investigated a bit the boot rom (I will post more details about the reverse engineering of that chip boot rom later) and I noticed that what happens is that, when the VBAT33 signal drops below about 2.3V, it triggers a tamper in the CPU. The way CPU deals with tamper is to actually reset itself, which in turn wipes the secure NVRAM and set some registers that can be checked by the boot rom or application. So basically, the reset button of the AIR105 is basically a tamper button 😆</p>

<p>So looking at the D177 PCB, there is no specific test pad to actually act as a reset, but usually to avoid spending the coin cell battery energy when the power is supplied there is a series diode which I can use for soldering my reset wire. By tracing the pads I could find that the diode was in edge of the board.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/ea6eb39aabf1f914c71bda9f6eb79907_MD5.jpeg" alt=""></p>

<p>So I just soldered a wire there, open my <a href="https://github.com/racerxdl/air105-uploader/">air105-uploader</a> program and manually set it to GND and <strong>PROFIT</strong></p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/a4da09ed6fa71e3bd9b38a0097594756_MD5.jpeg" alt="">
Now I could run code in the real machine!</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/3247c212e1baa37421f763ede653c022_MD5.jpeg" alt=""></p>

<h2 id="building-code-to-it">Building code to it</h2>

<p>I won’t get into much detail here (since this article is already getting bigger than I expected) but the TL;DR: LuatOS provides a way to build stuff, and has a “boiler plate” for initializing all the lua stuff. The CPU itself is a ARM Cortex so its easily buildable by GCC, just requiring a custom linker script to stitch everything in the right place.</p>

<p>Basically, I reused about everything I did for the AIR105, just changed the linker-script to be aware that MH1903 actually has 1MB of RAM instead 640KB. For making it easier to use, I created some <a href="https://platformio.org/">platform.io</a> libs that you can use directly.</p>

<p>If you want to try it, just install it through pip</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install</span> <span class="nt">-U</span> platformio
</code></pre></div></div>

<p>Then you can create a new project:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>my-project <span class="o">&amp;&amp;</span> <span class="nb">cd </span>my-project
pio init
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The following files/directories have been created in /tmp/m
include - Put project header files here
lib - Put project specific (private) libraries here
src - Put project source files here
platformio.ini - Project Configuration File
Project has been successfully initialized!
</code></pre></div></div>

<p>After that, you can just edit platformio.ini to map it to use the air105 platform:</p>
<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[env:air105]</span>
<span class="py">platform</span> <span class="p">=</span> <span class="err">https://github.com/racerxdl/platformio-air</span><span class="mi">105</span>
<span class="py">board</span> <span class="p">=</span> <span class="err">mh</span><span class="mi">1903</span>
<span class="py">framework</span> <span class="p">=</span> <span class="err">baremetal</span>
<span class="py">;monitor_port</span> <span class="p">=</span> <span class="err">SERIAL_PORT</span>
<span class="py">;monitor_speed</span> <span class="p">=</span> <span class="mi">115200</span>
<span class="py">monitor_rts</span> <span class="p">=</span> <span class="mi">0</span> <span class="err">;</span> <span class="err">AIR</span><span class="mi">105</span> <span class="err">board</span> <span class="err">has</span> <span class="err">inverted</span> <span class="err">RTS</span>
<span class="py">build_flags</span> <span class="p">=</span> <span class="err">-g</span> <span class="err">-ggdb</span>
</code></pre></div></div>

<p>You can change <code class="language-plaintext highlighter-rouge">board</code> parameter between <code class="language-plaintext highlighter-rouge">mh1903</code> and <code class="language-plaintext highlighter-rouge">air105</code> depending on what you’re targeting. The MH1903 is the 1MB variant, so code will crash on AIR105 due stack being positioned at the end of RAM space.</p>

<p>And for running:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pio run <span class="nt">-t</span> upload
</code></pre></div></div>

<p>This should build and upload (using the air105-uploader) directly. It will also download any toolchain and libs needed to do so. You can also add <code class="language-plaintext highlighter-rouge">-t monitor</code> to spawn a serial console and see the return from the machine.</p>

<p>The source code for the framework and platform on platform.io links are in the end of this article.</p>

<h2 id="magic-stuff">MAGIC STUFF</h2>

<p>So, this article is getting huge and I feel lots of details will be badly written if I keep pushing content here. After all, this is like a 4 years+ research project. So I will eventually write two more articles about how I did map some magic stuff.</p>

<p>When I say magic stuff, next sections of this article will assume we know how the LCD is wired to the CPU, which I initially guessed it was in the same port as  the flash memory we saw in the PCB. TL;DR it is, but not the Chip Select, neither the LCD backlight control, and these were not trivial to find since the LCD pinout is non-standard and I couldn’t find any datasheet of it.</p>

<p>I did emulate the firmware to figure out some stuff (other stuff was just looking at decompiled sections) and the magic stuff I discovered is that the pins that control the LCD, are mapped into a GPIO that <strong>does not exists</strong> according to the datasheet 😃 (Spoiler, there are <strong>two</strong> undocumented GPIOs and few other stuff)</p>

<p>For now, let’s just pretend I wrote a nice article on how I did those. I promise I will write a new one with details on the reverse engineering and the details on how I made an emulator for it (that could even show the LCD images) 👀</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/e129a7f1554e79536be3ca8d71fe03d9_MD5.jpeg" alt=""></p>

<h2 id="making-the-crasharalho">Making the “crasharalho”</h2>

<p>The “crasharalho” is a sticker I use a lot in discord and telegram. “Caralho” is sort of the portuguese equivalent of “fuck” in the sense “OMG”. So the Crash Bandicoot screaming it on the machine, seem a perfect fit.</p>

<p>Making it was easy, just created a 160x128 image in GIMP and stamped the sticker there.</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/67e6e21e4aca4b6c3ceeb47bf2b57530_MD5.jpeg" alt="">
Gimp is also nice that it can export directly to a C header, sort of compressed with a macro to actually get each R,G,B pixel values. So it was pretty easy to convert it.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* GIMP header image file format (RGB): include/crasharalho.h */</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">160</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>

<span class="cm">/* Call this macro repeatedly. After each use, the pixel data can be extracted */</span>

<span class="cp">#define HEADER_PIXEL(data,pixel) {\
pixel[0] = (((data[0] - 33) &lt;&lt; 2) | ((data[1] - 33) &gt;&gt; 4)); \
pixel[1] = ((((data[1] - 33) &amp; 0xF) &lt;&lt; 4) | ((data[2] - 33) &gt;&gt; 2)); \
pixel[2] = ((((data[2] - 33) &amp; 0x3) &lt;&lt; 6) | ((data[3] - 33))); \
data += 4; \
}
</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">header_data</span> <span class="o">=</span>

<span class="s">")#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A"</span>

<span class="s">")#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A)#!A"</span>
<span class="p">(...)</span>
</code></pre></div></div>

<p>The ST7735 LCD the machine uses has several pixel modes. I decided to use RGB565 since that would be exactly 16 bit wide (which gives two bytes over SPI) and easy to convert. I was lazy, so I used a local LLM to generate a macro to convert it, which worked pretty good (I didn’t remember how to convert the spaces, were not sure if was just cutting bits or actually a LUT)</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define RGB888_TO_RGB565(r, g, b) ( \
(((r) &amp; 0xF8) &lt;&lt; 8) | </span><span class="cm">/* 5 bits of red, shifted to bits 15-11 */</span><span class="cp"> \
(((g) &amp; 0xFC) &lt;&lt; 3) | </span><span class="cm">/* 6 bits of green, shifted to bits 10-5 */</span><span class="cp"> \
(((b) &amp; 0xF8) &gt;&gt; 3) </span><span class="cm">/* 5 bits of blue, shifted to bits 4-0 */</span><span class="cp"> \
)
</span></code></pre></div></div>

<p>LLM generated a bit cut, and it worked nice. So I left as is.  Then I could just send it in the code directly:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">{</span>
        <span class="c1">// 0x2C RAMWR</span>
        <span class="n">SendCMD</span><span class="p">(</span><span class="n">LCD_SPI</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">);</span>                <span class="c1">// RAMWR</span>
        <span class="n">P15_ON</span><span class="p">;</span>
        <span class="kt">uint8_t</span> <span class="n">rgb</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
        <span class="c1">// Fill the screen with white color // 16 bit mode</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">160</span> <span class="o">*</span> <span class="mi">128</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">HEADER_PIXEL</span><span class="p">(</span><span class="n">header_data</span><span class="p">,</span> <span class="n">rgb</span><span class="p">);</span>
            <span class="kt">uint16_t</span> <span class="n">color</span> <span class="o">=</span> <span class="n">RGB888_TO_RGB565</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
            <span class="n">SendCMDParam</span><span class="p">(</span><span class="n">LCD_SPI</span><span class="p">,</span><span class="n">color</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">);</span> <span class="c1">// Send high byte</span>
            <span class="n">SendCMDParam</span><span class="p">(</span><span class="n">LCD_SPI</span><span class="p">,</span> <span class="n">color</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span> <span class="c1">// Send low byte</span>
        <span class="p">}</span>
        <span class="n">P15_OFF</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>And tested it on my emulator:</p>

<p><img src="/assets/Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine/947b71be153e6405b62909b62e93385d_MD5.jpeg" alt=""></p>

<h2 id="result">Result</h2>

<p><img src="/assets/Running%20code%20in%20a%20Credit%20Card%20Payment%20Machine/23c966b8036e41fe19f78b38bfa8bf73_MD5.jpeg" alt=""></p>

<h2 id="next-steps">Next steps</h2>

<p>Running doom, of course :D - I planned of making this article only after doom, but I found out that the 1MB of ram, its sort of low for standard doom. I saw there is a RP2040 port of doom which works great, so I will probably port it to that core.</p>

<p>I still want to reverse engineer about everything I can from these SoCs, since they’re pretty powerful and has nice accelerators which can be used for some other secure stuff. I also managed to dump both MH1903S and MH1903 boot roms which has their own interesting aspects. I almost finished reversing engineering the MH1903S boot rom and I plan to make an article about it soon. It seens like that is several versions of boot roms around (they basically all do the same thing, but has different revisions and builds). So if you stumble across any MH190x device which you can either JTAG it or doesn’t have boot signature enabled. Let me know, lets make an archive of boot roms 😃</p>

<h2 id="notes">Notes</h2>

<ol>
  <li>There was a bit of research over both PAX and PagBank codes for finding out how it interacts with the hardware. No security flaw was explored and there is nothing they can do about the CPU swapping.</li>
  <li>There is nothing specific to PagBank in that case. Any D177 should work fine. The work here <strong>is not due a security flaw</strong>.</li>
  <li>Megahunt does a LOT of “Silicon OEM” (the AIR105 mentioned here is just one of them). Decaps should point out.</li>
  <li>Besides the boot rom, I don’t share binaries I dumped from machines. I hadn’t reverse engineer enough to know which info they store, and they might contain stuff that should be private. So please don’t ask, you can dump it yourself. Its pretty easy.</li>
  <li>Following articles will show how I reverse engineered the boot loaders, pax image format and found out how the LCD pins were mapped.</li>
</ol>

<h3 id="links">Links</h3>

<ul>
  <li>
<a href="https://github.com/racerxdl/platformio-air105">https://github.com/racerxdl/platformio-air105</a> - PIO Platform for AIR105/MH1903</li>
  <li>
<a href="https://github.com/racerxdl/framework-megahunt">https://github.com/racerxdl/framework-megahunt</a> - PIO Framework for Megahunt devices</li>
  <li>
<a href="https://github.com/racerxdl/air105-uploader">https://github.com/racerxdl/air105-uploader</a> - Python script to upload using the boot rom</li>
  <li>
<a href="https://archive.org/details/mh-1903-s-v-1.5">https://archive.org/details/mh-1903-s-v-1.5</a> - Some usefull MH1903 datasheets</li>
  <li>
<a href="https://github.com/racerxdl/d177-crasharalho">https://github.com/racerxdl/d177-crasharalho</a> - Crasharalho Source Code</li>
  <li>
<a href="https://github.com/racerxdl/megahunt-bootroms">https://github.com/racerxdl/megahunt-bootroms</a> - Megahunt Bootroms</li>
  <li>
<a href="https://github.com/racerxdl/mhdumper">https://github.com/racerxdl/mhdumper</a> - Megahunt ROM Dumper Tool</li>
</ul>

<h3 id="timeline">Timeline</h3>

<ul>
  <li>
<strong>01/04/2025</strong> - Resumed works on reverse-engineering and mapping</li>
  <li>
<strong>17/06/2025</strong> - Got first code running (crasharalho)</li>
  <li>
<strong>22/06/2025</strong> - Finished article, sent for peer review (tech-wise)</li>
  <li>
<strong>27/08/2025</strong> - Send the article to Pag for review</li>
  <li>
<strong>28/08/2025</strong> - Approved by Pag for publishing</li>
  <li>
<strong>31/08/2025</strong> - More reviews, translation, etc…</li>
  <li>
<strong>05/09/2025</strong> - Published</li>
</ul>


  <hr>
<div class="fb-comments" data-href="https://lucasteske.dev/2025/09/running-code-in-pax-machines" data-width="100%" data-numposts="5"></div>

<hr>
<div class="sharebuttons">
  <ul>
    <li>
      <p class="sharetitle"> Share this: </p>
    </li>
    <li class="reddit">
      <a href="http://www.reddit.com/submit?url=https://lucasteske.dev/2025/09/running-code-in-pax-machines&amp;title=Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine%20(part1)" target="_blank">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Reddit icon</title>
<path d="M2.204 14.049c-.06.276-.091.56-.091.847 0 3.443 4.402 6.249 9.814 6.249 5.41 0 9.812-2.804 9.812-6.249 0-.274-.029-.546-.082-.809l-.015-.032c-.021-.055-.029-.11-.029-.165-.302-1.175-1.117-2.241-2.296-3.103-.045-.016-.088-.039-.126-.07-.026-.02-.045-.042-.067-.064-1.792-1.234-4.356-2.008-7.196-2.008-2.815 0-5.354.759-7.146 1.971-.014.018-.029.033-.049.049-.039.033-.084.06-.13.075-1.206.862-2.042 1.937-2.354 3.123 0 .058-.014.114-.037.171l-.008.015zm9.773 5.441c-1.794 0-3.057-.389-3.863-1.197-.173-.174-.173-.457 0-.632.176-.165.46-.165.635 0 .63.629 1.685.943 3.228.943 1.542 0 2.591-.3 3.219-.929.165-.164.45-.164.629 0 .165.18.165.465 0 .645-.809.808-2.065 1.198-3.862 1.198l.014-.028zm-3.606-7.573c-.914 0-1.677.765-1.677 1.677 0 .91.763 1.65 1.677 1.65s1.651-.74 1.651-1.65c0-.912-.739-1.677-1.651-1.677zm7.233 0c-.914 0-1.678.765-1.678 1.677 0 .91.764 1.65 1.678 1.65s1.651-.74 1.651-1.65c0-.912-.739-1.677-1.651-1.677zm4.548-1.595c1.037.833 1.8 1.821 2.189 2.904.45-.336.719-.864.719-1.449 0-1.002-.815-1.816-1.818-1.816-.399 0-.778.129-1.09.363v-.002zM2.711 9.963c-1.003 0-1.817.816-1.817 1.818 0 .543.239 1.048.644 1.389.401-1.079 1.172-2.053 2.213-2.876-.302-.21-.663-.329-1.039-.329v-.002zm9.217 12.079c-5.906 0-10.709-3.205-10.709-7.142 0-.275.023-.544.068-.809C.494 13.598 0 12.729 0 11.777c0-1.496 1.227-2.713 2.725-2.713.674 0 1.303.246 1.797.682 1.856-1.191 4.357-1.941 7.112-1.992l1.812-5.524.404.095s.016 0 .016.002l4.223.993c.344-.798 1.138-1.36 2.065-1.36 1.229 0 2.231 1.004 2.231 2.234 0 1.232-1.003 2.234-2.231 2.234s-2.23-1.004-2.23-2.23l-3.851-.912-1.467 4.477c2.65.105 5.047.854 6.844 2.021.494-.464 1.144-.719 1.833-.719 1.498 0 2.718 1.213 2.718 2.711 0 .987-.54 1.886-1.378 2.365.029.255.059.494.059.749-.015 3.938-4.806 7.143-10.72 7.143l-.034.009zm8.179-19.187c-.74 0-1.34.599-1.34 1.338 0 .738.6 1.34 1.34 1.34.732 0 1.33-.6 1.33-1.334 0-.733-.598-1.332-1.347-1.332l.017-.012z"></path></svg>
      </a>
    </li>
    <li class="hn">
      <a href="http://news.ycombinator.com/submitlink?u=https://lucasteske.dev/2025/09/running-code-in-pax-machines&amp;t=Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine%20(part1)" target="_blank">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Y Combinator icon</title>
<path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"></path></svg>
      </a>
    </li>
    <li class="twitter">
      <a href="https://twitter.com/intent/tweet?via=lucasteske&url=https://lucasteske.dev/2025/09/running-code-in-pax-machines&amp;text=Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine%20(part1)" target="_blank">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter icon</title>
<path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg>
      </a>
    </li>
    <li class="linkedin">
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://lucasteske.dev/2025/09/running-code-in-pax-machines&amp;title=Running%20code%20in%20a%20PAX%20Credit%20Card%20Payment%20Machine%20(part1)" target="_blank">
        <svg role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn icon</title>
<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg>
      </a>
    </li>
  </ul>
</div>

</div>

<div class="pagination">
  
  
    <a href="/2024/01/tpm2-bitlocker-keys" class="right arrow">→</a>
  

  <a href="#" class="top">Top</a>
</div>

      <br><br>
    </main>

    <footer>
  <span>
    © <time datetime="2025-09-05 19:03:53 -0300">2025</time> Lucas Teske. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span><br>
  <span class="site-build">
    Last build: 2025-09-05 19:03:53 -0300
  </span>
  <!-- hehehe -->
  <img src="https://ipv4.games/claim?name=racerxdl" height="2" width="2">
</footer>

<script src="/assets/simple-jekyll-search.min.js"></script>
<script>
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/search.json',
    searchResultTemplate: '<li><a href="https://lucasteske.dev{url}">{date} - {title}</a></li>'
  })
</script>

<!-- Google Tag Manager (noscript) -->
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P2HPZJM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
<!-- AnchorJS -->
<script src="/assets/anchor.min.js"></script>
<script>
  anchors.options.placement = 'left';
  anchors.add('h1');
  anchors.add();
</script>
<!-- End AnchorJS -->
<!-- Cloudflare Web Analytics -->
<script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "6fdff3f05d2847b58d553381bb1e8115"}'></script>
<!-- End Cloudflare Web Analytics -->

  </body>
</html>
